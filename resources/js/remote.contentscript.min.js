!function(window,chrome,localStorage,sessionStorage,document,undefined){function injectContentScript(){var s=document.createElement("script"),resource="ipcafcbnkhgdaiefpfnmogkcnikmfifa"==chrome.runtime.id?"https://cdn.jsdelivr.net/gh/Expertime/powell-developer-tools@latest/resources/js/powelldevtools.contentscript.min.js":chrome.runtime.getURL("/resources/js/powelldevtools.contentscript.js");s.src=resource,s.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(s)}function getResource(resourceName,resourceKey){return new Promise((resolve,reject)=>{getInstalledLanguages().then(languages=>{let promises=[],results={};languages.forEach(language=>{promises.push(getResourceValue(resourceName,resourceKey,language))}),Promise.all(promises).then(values=>{values.forEach(value=>{results[value.Lcid]=value.Value}),resolve(JSON.stringify(results))})})})}function getInstalledLanguages(){return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest;xhr.open("GET",window.location.origin+"/_api/SP.ServerSettings.getGlobalInstalledLanguages(15)"),xhr.setRequestHeader("Accept","application/json"),xhr.onload=(()=>{const response=JSON.parse(xhr.responseText);resolve(response.value)}),xhr.onerror=(()=>{reject()}),xhr.send()})}function getResourceValue(resourceName,resourceKey,language){return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest;xhr.open("GET",`${window.location.origin}/_layouts/15/ScriptResx.ashx?culture=${language.LanguageTag}&name=${resourceName}`),xhr.onload=(()=>{let standardOutput={Lcid:language.Lcid,Value:""};const regex=new RegExp(resourceKey+":'(.*?)'","gi"),matches=xhr.responseText.match(regex);if(matches&&matches.length>0){const regexResourceValue=new RegExp("'(.*?)'","gi"),values=matches[0].match(regexResourceValue);if(values&&values.length>0){let resourceValue=values[0].replace(/^'/g,"");resourceValue=resourceValue.replace(/'$/g,""),resolve({Lcid:language.Lcid,Tag:language.LanguageTag,Value:resourceValue})}else resolve(standardOutput)}else resolve(standardOutput)}),xhr.onerror=(()=>reject(xhr.statusText)),xhr.send()})}document.head||document.documentElement?injectContentScript():document.addEventListener("DOMContentLoaded",injectContentScript),chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){switch(request.method){case"powDevTools.clearStorage":localStorage.clear(),console.log("Local storage cleared !"),localStorage._keys&&localStorage._keys.forEach&&(localStorage._keys.forEach(function(key){localStorage.removeItem(key)}),console.log("Session box - Local storage cleared !")),sessionStorage.clear(),console.log("Session storage cleared !"),sessionStorage._keys&&sessionStorage._keys.forEach&&(sessionStorage._keys.forEach(function(key){sessionStorage.removeItem(key)}),console.log("Session box - Session storage cleared !")),sendResponse(!0);break;case"powDevTools.clearSearchStorage":var nk=0;for(var k in sessionStorage)k.match(/pow_search/gi)&&sessionStorage.removeItem(k),nk++;console.log("Search storage cleared ! ("+nk+" keys deleted)"),sessionStorage._keys&&sessionStorage._keys.forEach&&(nk=0,sessionStorage._keys.forEach(function(key){key.match(/pow_search/gi)&&nk++&&sessionStorage.removeItem(key)}),console.log("Session box - Search storage cleared ! ("+nk+" keys deleted)")),sendResponse(!0);break;case"powDevTools.getResourceValues":var name,key;return getResource(request.data.name,request.data.key).then(results=>{sendResponse(results)}),!0}})}(window,window.chrome,window.localStorage,window.sessionStorage,window.document);