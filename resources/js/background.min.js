(function(e,t,o,n,r){"use strict";function l(e,t){return new y(e,t)}function s(e){o.declarativeContent.onPageChanged.getRules(r,function(e){}),o.declarativeContent.onPageChanged.removeRules(r,function(){o.declarativeContent.onPageChanged.getRules(r,function(e){}),o.declarativeContent.onPageChanged.addRules([R],function(e){o.declarativeContent.onPageChanged.getRules(r,function(e){})})})}var i="datacontextConfig";t.module("powellDevTools").factory(i,["$q","datacontextUtility",l]);var c=function(e){var t=e.url,o=e.url,n=/(cdn.powell-365.com|powell365-cdn.azureedge.net)\/scripts\/(?:powell(?:\/debug)?\?siteCollectionUrl=|Premium)/i,r=/powell365-cdn.azureedge.net/i,l=/#powellDevTools=1/,s=!l.exec(t)&&n.exec(t);if(s){var i=null!=r.exec(t);o=y.utility.get_jsSourceUrl(i)+"#powellDevTools=1"}return{redirectUrl:o}},a=function(e){var t,o=e.url,n=e.url,r=/powell365-cdn.azureedge.net/i,l=/[^\/\\&\?]+\.\w{3,4}(?=([\?&].*$|$))/;if(t=y.utility.get_defautCssOnCdnState()?/(?:cdn.powell-365.com|powell365-cdn.azureedge.net)\/styles\//i:y.utility.get_defaultCssURL()){if(t.exec&&null!==t.exec(o)||o.indexOf(t)>=0){var s=null!=r.exec(o),i=o.match(l)[0];n=y.utility.get_cssSourceUrl(i,s)}return{redirectUrl:n}}},u=[],d=function(e){u[e.tabId]=!u[e.tabId];var t=e.url,o=e.url,n=/powell365-cdn.azureedge.net/i;null!=n.exec(t);if(o=y.utility.get_headerFooterHtmlTemplateUrl(t,u[e.tabId]),o!=t)return{redirectUrl:o}},g=function(e){var t=e.url,o=e.url,n=/(?:cdn.powell-365.com|powell365-cdn.azureedge.net)\/+(?:(?:\w|\S)+\/+)+(\S+\.html)/i,r=n.exec(t);if(r){var l=y.utility.get_htmlTemplate(r[1]);l.isOverriden&&(o=y.utility.get_htmlSourceUrl(l.fileName))}return{redirectUrl:o}},m=function(e){var t=e.url,o=e.url,n=/(?:cdn.powell-365.com|powell365-cdn.azureedge.net)\/styles.*\/logo-my-portal\.png/i,r=/powell365-cdn.azureedge.net/i,l="logo-my-portal.png";if(null!==n.exec(t)){var s=null!=r.exec(t);o=y.utility.get_logoSourceUrl(l,s)}return{redirectUrl:o}},p=function(e){for(var t=!1,o=e.requestHeaders,n={},r=0,l=o.length;r<l;++r)if("Referer"==o[r].name){o[r].value=y.utility.get_xhrOrigin(),t=!0;break}return t||o.push({name:"Referer",value:y.utility.get_xhrOrigin()}),n.requestHeaders=o,n},w=function(e,t){for(var o=[],n=0;n<e.length;n++)for(var r=0;r<t.length;r++)o.push(e[n]+t[r]);return o},f=function(e,t,n){if(e){var r=["*://r7-cdn.powell-365.com/","*://cdn.powell-365.com/","*://r7-powell365-cdn.azureedge.net/","*://powell365-cdn.azureedge.net/"],l=["styles/Premium/*/*/*/images/logo-my-portal.png"],s=["styles/Premium/*/*/*/powell.css"],i=["scripts/Premium/*/*/*/powell"],u=["Common/*/*/*//HtmlTemplates/*"],f=["Common/*/*/*//layouts/*.html","Common/*/*/*//Templates/*/*.html","Common//Templates/*/*.html"],h="*://*/*",v={},x=["blocking"];switch(t){case"js":v.types=["script"],v.urls=w(r,i),o.webRequest.onBeforeRequest.addListener(c,v,x);break;case"css":v.types=["image"],v.urls=w(r,l),o.webRequest.onBeforeRequest.addListener(m,v,x),v.types=["stylesheet"],v.urls=w(r,s),v.urls.push(h),o.webRequest.onBeforeRequest.addListener(a,v,x),v.urls=w(r,u),v.types=["xmlhttprequest"],o.webRequest.onBeforeRequest.addListener(d,v,x);break;case"html":v.urls=w(r,f),v.types=["xmlhttprequest"],o.webRequest.onBeforeRequest.addListener(g,v,x);case"xhr":v.urls=w(r,["*"]),v.types=["xmlhttprequest"],x.push("requestHeaders"),o.webRequest.onBeforeSendHeaders.addListener(p,v,x)}}else switch(t){case"js":o.webRequest.onBeforeRequest.removeListener(c);break;case"css":o.webRequest.onBeforeRequest.removeListener(a),o.webRequest.onBeforeRequest.removeListener(m);break;case"xhr":o.webRequest.onBeforeSendHeaders.removeListener(p)}y.utility.set_isEnabled(t,e),b()},h=function(e,t){o.webRequest.onBeforeRequest.hasListener(d)},v=function(t){t!=e.PDT_GLOBAL&&o.runtime.reload()},b=function(){var e=y.utility.enabledFourState(),t=(y.icons[e]||y.icons.all).color,n=y.icons[e]&&y.icons[e].text||e,r=(y.icons[e]||y.icons.all).icon;o.browserAction.setBadgeBackgroundColor({color:t}),o.browserAction.setBadgeText({text:n}),o.browserAction.setIcon({path:r})},x=function(e,t,o){return"powDevTools.setEnabled"==e.action&&f(e.enabled,e.sourceKind),"powDevTools.checkScriptFreshness"==e.action&&v(e.globalMD5),"powDevTools.valueUpdated"==e.action&&h(e.data.name,e.data.value),!0},y=function(e,t){y.$q=e,y.utility=t,y.icons={js:{color:"#EFBE19",text:"js",icon:"resources/img/icon19.png"},css:{color:"#2FA9DA",text:"css",icon:"resources/img/icon19.png"},html:{color:"#cd62f3",text:"html",icon:"resources/img/icon19.png"},xhr:{color:"#2af32d",text:"xhr",icon:"resources/img/icon19.png"},all:{color:"#F3672A",text:"all",icon:"resources/img/icon19.png"},none:{color:"#000",text:"none",icon:"resources/img/icon19_disabled.png"}}},q=function(){n.PowellDevTools_js_enabled=!1,n.PowellDevTools_css_enabled=!1,n.PowellDevTools_xhr_enabled=!1,n.PowellDevTools_html_enabled=!1,o.browserAction.setBadgeText({text:""}),o.runtime.onMessage.addListener(x),b()};t.module("powellDevTools").run(["datacontextConfig",q]),o.notifications.create(null,{type:"basic",iconUrl:"resources/img/icon128.png",title:"Powell Dev Tools",message:"Plugin reloaded."});var R={id:"PowellDevTools_contentScript_loader",conditions:[new o.declarativeContent.PageStateMatcher({pageUrl:{urlMatches:".sharepoint.com",schemes:["https"]}})],actions:[new o.declarativeContent.RequestContentScript({js:["ipcafcbnkhgdaiefpfnmogkcnikmfifa"==o.runtime.id?"/resources/js/contentscript.min.js":"/resources/js/contentscript.js"]})]};o.extension.inIncognitoContext?s():o.runtime.onInstalled.addListener(s)})(window,window.angular,window.chrome,window.localStorage);