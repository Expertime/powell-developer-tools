!function(e,t,o,n,r){"use strict";var l="datacontextConfig";function s(e,t){return new q(e,t)}t.module("powellDevTools").factory(l,["$q","datacontextUtility",s]);var c=function(e){var t=e.url,o=e.url,n=/(cdn.powell-365.com|powell365-cdn.azureedge.net|cdn(?:edge)?test.powell-software.com)\/scripts\/(?:powell(?:\/debug)?\?siteCollectionUrl=|Premium|appmobile)/i,r=/powell365-cdn.azureedge.net/i,l,s;if(!/\?pdtOriginalJs=.+/.exec(t)&&n.exec(t)){var c=null!=r.exec(t);o=q.utility.get_jsSourceUrl(c)+"?pdtOriginalJs="+encodeURIComponent(e.url)}return{redirectUrl:o}},i=function(e){var t=e.url,o=e.url,n,r=/powell365-cdn.azureedge.net/i,l=/[^/\\&\?]+\.\w{3,4}(?=([\?&].*$|$))/;if(n=q.utility.get_defautCssOnCdnState()?/(?:cdn.powell-365.com|powell365-cdn.azureedge.net|cdn(?:edge)?test.powell-software.com)\/styles\//i:q.utility.get_defaultCssURL()){if(n.exec&&null!==n.exec(t)||t.indexOf(n)>=0){var s=null!=r.exec(t),c=t.match(l)[0];o=q.utility.get_cssSourceUrl(c,s)}return{redirectUrl:o}}},a=[],u=function(e){a[e.tabId]=!a[e.tabId];var t=e.url,o=e.url,n,r=null!=/powell365-cdn.azureedge.net/i.exec(t);if((o=q.utility.get_headerFooterHtmlTemplateUrl(t,a[e.tabId]))!=t)return{redirectUrl:o}},d=function(e){var t=e.url,o=e.url,n=/(?:cdn.powell-365.com|powell365-cdn.azureedge.net|cdn(?:edge)?test.powell-software.com)\/(.*)(?<!\.\w*)$/i,r,l=!/#powellDevTools=1/.exec(t)&&n.exec(t);return l&&(o=q.utility.get_cdnSourceUrl(l[1])+"#powellDevTools=1"),{redirectUrl:o}},p=function(e){var t=e.url,o=e.url,n,r=/(?:cdn.powell-365.com|powell365-cdn.azureedge.net|cdn(?:edge)?test.powell-software.com)\/+(?:(?:\w|\S)+\/+)+(\S+\.html)/i.exec(t);if(r){var l=q.utility.get_htmlTemplate(r[1]);l.isOverriden&&(o=q.utility.get_htmlSourceUrl(l.fileName))}return{redirectUrl:o}},m=function(e){var t=e.url,o=e.url,n,r=/powell365-cdn.azureedge.net/i,l="logo-my-portal.png";if(null!==/(?:cdn.powell-365.com|powell365-cdn.azureedge.net|cdn(?:edge)?test.powell-software.com)\/styles.*\/logo-my-portal\.png/i.exec(t)){var s=null!=r.exec(t);o=q.utility.get_logoSourceUrl(l,s)}return{redirectUrl:o}},g=function(e){for(var t=!1,o=e.requestHeaders,n={},r=0,l=o.length;r<l;++r)if("Referer"==o[r].name){o[r].value=q.utility.get_xhrOrigin(),t=!0;break}return t||o.push({name:"Referer",value:q.utility.get_xhrOrigin()}),n.requestHeaders=o,n},w=function(e){var t;return{redirectUrl:e.url+'#"%7B%22Querytext%22:%22%22,%22QueryTemplate%22:%22%7BsearchTerms%7D%20ContentClass=urn:content-class:SPSPeople%22%7D"'}},f=function(e,t){for(var o=[],n=0;n<e.length;n++)for(var r=0;r<t.length;r++)o.push(e[n]+t[r]);return o},v=function(e,t,n){if(e){var r=["*://cdntest.powell-software.com/","*://cdnedgetest.powell-software.com/","*://cdn.powell-365.com/","*://r7-powell365-cdn.azureedge.net/","*://powell365-cdn.azureedge.net/"],l=["styles/Premium/*/*/*/images/logo-my-portal.png"],s=["styles/Premium/*/*/*/powell.css"],a=["scripts/Premium/*/*/*/powell*","scripts/appmobile/*/*/powell"],w=["Common/*/*/*//HtmlTemplates/*"],v=["Common/*/*/*//layouts/*.html","Common/*/*/*//Templates/*/*.html","Common//Templates/*/*.html"],h="*://*/*",b={},y=["blocking"];switch(t){case"js":b.types=["script"],b.urls=f(r,a),o.webRequest.onBeforeRequest.addListener(c,b,y);break;case"css":b.types=["image"],b.urls=f(r,l),o.webRequest.onBeforeRequest.addListener(m,b,y),b.types=["stylesheet"],b.urls=f(r,s),b.urls.push(h),o.webRequest.onBeforeRequest.addListener(i,b,y),b.urls=f(r,w),b.types=["xmlhttprequest"],o.webRequest.onBeforeRequest.addListener(u,b,y);break;case"cdn":b.types=["xmlhttprequest"],b.urls=f(r,"*"),o.webRequest.onBeforeRequest.addListener(d,b,y);break;case"html":b.urls=f(r,v),b.types=["xmlhttprequest"],o.webRequest.onBeforeRequest.addListener(p,b,y);case"xhr":b.urls=f(r,["*"]),b.types=["xmlhttprequest"],y.push("requestHeaders"),o.webRequest.onBeforeSendHeaders.addListener(g,b,y)}}else switch(t){case"js":o.webRequest.onBeforeRequest.removeListener(c);break;case"css":o.webRequest.onBeforeRequest.removeListener(i),o.webRequest.onBeforeRequest.removeListener(m);break;case"cdn":o.webRequest.onBeforeSendHeaders.removeListener(d);break;case"xhr":o.webRequest.onBeforeSendHeaders.removeListener(g)}q.utility.set_isEnabled(t,e),x()},h=function(e,t){o.webRequest.onBeforeRequest.hasListener(u)},b=function(t){t!=e.PDT_GLOBAL&&o.runtime.reload()},x=function(){var e=q.utility.enabledState(),t=(q.icons[e]||q.icons.all).color,n=q.icons[e]&&q.icons[e].text||e,r=(q.icons[e]||q.icons.all).icon;o.browserAction.setBadgeBackgroundColor({color:t}),o.browserAction.setBadgeText({text:n}),o.browserAction.setIcon({path:r})},y=function(e,t,o){return"powDevTools.setEnabled"==e.action&&v(e.enabled,e.sourceKind),"powDevTools.checkScriptFreshness"==e.action&&b(e.globalMD5),"powDevTools.valueUpdated"==e.action&&h(e.data.name,e.data.value),!0},q=function(e,t){q.$q=e,q.utility=t,q.icons={js:{color:"#EFBE19",text:"js",icon:"resources/img/icon19.png"},css:{color:"#2FA9DA",text:"css",icon:"resources/img/icon19.png"},cdn:{color:"#2c19ef",text:"cdn",icon:"resources/img/icon19.png"},html:{color:"#cd62f3",text:"html",icon:"resources/img/icon19.png"},xhr:{color:"#2af32d",text:"xhr",icon:"resources/img/icon19.png"},all:{color:"#F3672A",text:"all",icon:"resources/img/icon19.png"},none:{color:"#000",text:"none",icon:"resources/img/icon19_disabled.png"}}},R=function(){n.PowellDevTools_js_enabled=!1,n.PowellDevTools_css_enabled=!1,n.PowellDevTools_xhr_enabled=!1,n.PowellDevTools_html_enabled=!1,o.browserAction.setBadgeText({text:""}),o.runtime.onMessage.addListener(y),x()};t.module("powellDevTools").run(["datacontextConfig",R]);var C={id:"PowellDevTools_SP_contentScript_loader",conditions:[new o.declarativeContent.PageStateMatcher({pageUrl:{urlMatches:".sharepoint.com",schemes:["https"]}})],actions:[new o.declarativeContent.RequestContentScript({js:["ipcafcbnkhgdaiefpfnmogkcnikmfifa"==o.runtime.id?"/resources/js/sp.contentscript.min.js":"/resources/js/sp.contentscript.js"]})]};function _(e){o.declarativeContent.onPageChanged.getRules(void 0,(function(e){})),o.declarativeContent.onPageChanged.removeRules(void 0,(function(){o.declarativeContent.onPageChanged.getRules(void 0,(function(e){})),o.declarativeContent.onPageChanged.addRules([C],(function(e){o.declarativeContent.onPageChanged.getRules(void 0,(function(e){}))}))}))}o.extension.inIncognitoContext?_():o.runtime.onInstalled.addListener(_)}(window,window.angular,window.chrome,window.localStorage);